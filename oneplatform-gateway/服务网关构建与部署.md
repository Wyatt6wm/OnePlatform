# 服务网关构建与部署

构建镜像前，先修改环境标志为`run`。再 maven install 构建 jar 包：

```yaml
sys:
  env: run
```

在项目根目录下构建 Dockerfile，按照如下模板填入构建命令：

```dockerfile
FROM openjdk:15.0.2-oraclelinux8
ADD target/oneplatform-gateway.jar application.jar
ENTRYPOINT ["java", "-jar", "/application.jar"]
EXPOSE 8000
```

构建镜像并推送到 dockerhub 仓库（注意标签版本号）：

```shell
# 在Dockerfile文件所在目录下运行
docker build -t wyatt6/oneplatform-gateway:1.0 ./
docker push wyatt6/oneplatform-gateway:1.0
```

拉取镜像（注意标签版本号）：

```shell
docker network create oneplatform-net
docker pull wyatt6/oneplatform-gateway:1.0
```

运行容器（注意标签版本号）：

```shell
docker run --name oneplatform-gateway -d -p 8000:8000/tcp --net oneplatform-net --restart=unless-stopped -e TZ="Asia/Shanghai" wyatt6/oneplatform-gateway:1.0
```

